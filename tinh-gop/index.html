<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí∞ T√≠nh G√≥p - T·∫°p Ho√° Neil</title>
    <meta name="description" content="√îm g√≥p h·ªô anh em li√™n h·ªá em Thi√™n - Zalo 0987.098.033">
    
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="page-container">
        <main class="main-content">
            <div class="calculator-container">
                <form class="calculator-form" id="calculator-form">
                    <div class="form-group">
                        <label for="product-price-page" class="form-label">
                            <span class="label-icon">üíµ</span>Gi√° Acc
                        </label>
                        <input 
                            type="text" 
                            id="product-price-page" 
                            class="form-input" 
                            onfocus="removeCurrencySymbol('product-price-page')" 
                            onblur="addCurrencySymbol('product-price-page')" 
                            oninput="formatCurrencyInput('product-price-page'); updateDownPaymentAndInstallmentPeriod();" 
                            placeholder="Nh·∫≠p gi√° acc"
                        >
                    </div>

                    <div class="form-group">
                        <label for="down-payment" class="form-label">
                            <span class="label-icon">üí≥</span>Tr·∫£ Tr∆∞·ªõc (Min 30%)
                        </label>
                        <input 
                            type="text" 
                            id="down-payment" 
                            class="form-input" 
                            data-value="0" 
                            onfocus="removeCurrencySymbol('down-payment')" 
                            onblur="addCurrencySymbol('down-payment')" 
                            oninput="formatCurrencyInput('down-payment')" 
                            placeholder="S·ªë ti·ªÅn tr·∫£ tr∆∞·ªõc"
                        >
                    </div>

                    <div class="form-group">
                        <label for="installment-period" class="form-label">
                            <span class="label-icon">üìÖ</span>Th·ªùi Gian G√≥p (Th√°ng)
                        </label>
                        <select id="installment-period" class="form-select">
                            <option value="1">1 th√°ng</option>
                            <option value="2">2 th√°ng</option>
                            <option value="3">3 th√°ng</option>
                            <option value="4">4 th√°ng</option>
                            <option value="5">5 th√°ng</option>
                            <option value="6">6 th√°ng</option>
                            <option value="7">7 th√°ng</option>
                            <option value="8">8 th√°ng</option>
                            <option value="9">9 th√°ng</option>
                            <option value="10">10 th√°ng</option>
                            <option value="11">11 th√°ng</option>
                            <option value="12">12 th√°ng</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="interest-rate" class="form-label">
                            <span class="label-icon">üìä</span>Ph√≠ (%)
                        </label>
                        <input 
                            type="number" 
                            id="interest-rate" 
                            class="form-input" 
                            min="3" 
                            max="10" 
                            step="0.1" 
                            value="10" 
                            oninput="validateInterestRate()" 
                            placeholder="3.0 - 10.0"
                        >
                    </div>

                    <div class="form-group">
                        <label for="minimum-interest" class="form-label">
                            <span class="label-icon">üí∞</span>Ph√≠ T·ªëi Thi·ªÉu
                        </label>
                        <input 
                            type="text" 
                            id="minimum-interest" 
                            class="form-input" 
                            data-value="0" 
                            onfocus="removeCurrencySymbol('minimum-interest')" 
                            onblur="addCurrencySymbol('minimum-interest')" 
                            oninput="formatCurrencyInput('minimum-interest')" 
                            placeholder="0 ƒë"
                        >
                    </div>

                    <button type="button" class="calculate-button" onclick="calculateInstallment()">
                        <span class="button-icon">üßÆ</span>T√≠nh To√°n
                    </button>
                </form>

                <div class="results" id="results" style="display: none;">
                    <div class="result-item" id="result-debt"></div>
                    <div class="result-item payment-details" id="result-details"></div>
                </div>
            </div>
        </main>
        
        <footer class="footer">
            <p class="footer-text">√îm g√≥p h·ªô anh em li√™n h·ªá em <a href="https://zalo.me/0987098033" target="_blank">Thi√™n - Zalo 0987.098.033</a></p>
        </footer>
    </div>

    <script>
    function formatCurrencyInput(id) {
        let input = document.getElementById(id);
        let rawValue = input.value.replace(/\D/g, '');
        
        if (rawValue) {
            let formattedValue = new Intl.NumberFormat('vi-VN').format(rawValue);
            input.value = formattedValue;
            input.setAttribute('data-value', rawValue);
        } else {
            input.value = '';
            input.setAttribute('data-value', '0');
        }
    }

    function removeCurrencySymbol(id) {
        let input = document.getElementById(id);
        input.value = input.value.replace(/ ƒë/g, '');
    }

    function addCurrencySymbol(id) {
        let input = document.getElementById(id);
        let rawValue = input.getAttribute('data-value');
        
        if (rawValue) {
            let formattedValue = new Intl.NumberFormat('vi-VN').format(rawValue);
            input.value = formattedValue + ' ƒë';
        }
    }

    function getNumericValue(id) {
        let input = document.getElementById(id);
        return parseInt(input.getAttribute('data-value'), 10);
    }

    function validateInterestRate() {
        let interestRateInput = document.getElementById("interest-rate");
        let value = parseFloat(interestRateInput.value);
        
        if (value < 3) {
            interestRateInput.value = 3;
        } else if (value > 10) {
            interestRateInput.value = 10;
        }
    }

    function updateDownPaymentAndInstallmentPeriod() {
        let productPrice = getNumericValue("product-price-page");
        let downPaymentField = document.getElementById("down-payment");
        
        if (productPrice) {
            let minimumDownPayment = productPrice * 0.3;
            downPaymentField.value = new Intl.NumberFormat('vi-VN').format(Math.round(minimumDownPayment)) + ' ƒë';
            downPaymentField.setAttribute('data-value', Math.round(minimumDownPayment));
        } else {
            downPaymentField.value = '';
            downPaymentField.setAttribute('data-value', '0');
        }
    }

    function calculateInstallment() {
        let productPrice = getNumericValue("product-price-page");
        let downPayment = getNumericValue("down-payment");
        let installmentPeriod = parseInt(document.getElementById("installment-period").value);
        let interestRate = parseFloat(document.getElementById("interest-rate").value) / 100;
        let minimumInterest = getNumericValue("minimum-interest");
        
        if (isNaN(productPrice) || isNaN(downPayment) || isNaN(installmentPeriod) || isNaN(interestRate)) {
            showError("Thi·∫øu d·ªØ li·ªáu t√≠nh to√°n.");
            return;
        }
        
        let minimumDownPayment = productPrice * 0.3;
        if (downPayment < minimumDownPayment) {
            showError(`S·ªë ti·ªÅn tr·∫£ tr∆∞·ªõc √≠t nh·∫•t ph·∫£i l√† ${new Intl.NumberFormat('vi-VN').format(minimumDownPayment)} ƒë.`);
            return;
        }
        
        let debt = Math.round(productPrice - downPayment);
        let principalPayment = Math.round(debt / installmentPeriod);
        let paymentDetails = "";
        let totalInterest = 0;
        
        for (let i = 1; i <= installmentPeriod; i++) {
            let calculatedInterest = Math.round(debt * interestRate);
            let interest = Math.max(calculatedInterest, minimumInterest);
            let monthlyPayment = Math.round(principalPayment + interest);
            totalInterest += interest;
            
            paymentDetails += `Th√°ng ${i}: ${new Intl.NumberFormat('vi-VN').format(monthlyPayment)} ƒë<br>&nbsp;&nbsp;N·ª£: ${new Intl.NumberFormat('vi-VN').format(debt)} ƒë<br>&nbsp;&nbsp;Ph√≠: ${new Intl.NumberFormat('vi-VN').format(interest)} ƒë<br><br>`;
            debt = Math.round(debt - principalPayment);
        }
        
        let totalPayment = Math.round(productPrice - downPayment) + totalInterest;
        
        document.getElementById("result-debt").innerHTML = 
            `<div class="summary-item">
                <span class="summary-label">üí∞ T·ªïng N·ª£:</span>
                <span class="summary-value">${new Intl.NumberFormat('vi-VN').format(Math.round(productPrice - downPayment))} ƒë</span>
            </div>`;
        
         document.getElementById("result-details").innerHTML = 
             `<div class="payment-schedule">
                 ${paymentDetails}
             </div>`;
        
        document.getElementById("results").style.display = "block";
        document.getElementById("results").scrollIntoView({ behavior: 'smooth' });
    }

    function showError(message) {
        document.getElementById("result-details").innerHTML = 
            `<div class="error-message">
                <span class="error-icon">‚ö†Ô∏è</span>${message}
            </div>`;
        document.getElementById("results").style.display = "block";
    }

    document.addEventListener('DOMContentLoaded', function() {
        updateDownPaymentAndInstallmentPeriod();
    });
    </script>
</body>
</html>